"""atualizacao do marchant

Revision ID: a8af7603f2be
Revises: b78512723ba8
Create Date: 2025-11-15 13:24:22.437287

"""

from __future__ import annotations

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'a8af7603f2be'
down_revision = 'b78512723ba8'
branch_labels = None
depends_on = None


def upgrade() -> None:
    """Apply upgrade migrations."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('agendamentos', sa.Column('preco_confirmado', sa.Numeric(precision=10, scale=2), nullable=True))
    op.add_column('agendamentos', sa.Column('endereco_atendimento', sa.JSON(), nullable=False))
    op.add_column('agendamentos', sa.Column('canal', sa.Enum('WEB', 'MOBILE', 'BACKOFFICE', name='pedidoorigem'), nullable=False))
    op.add_column('agendamentos', sa.Column('notas_internas', sa.Text(), nullable=True))
    op.add_column('agendamentos', sa.Column('data_confirmacao', sa.DateTime(timezone=True), nullable=True))
    op.add_column('agendamentos', sa.Column('data_cancelamento', sa.DateTime(timezone=True), nullable=True))
    op.add_column('agendamentos', sa.Column('motivo_cancelamento', sa.String(length=255), nullable=True))
    op.add_column('categorias', sa.Column('slug', sa.String(length=150), nullable=True))
    op.add_column('categorias', sa.Column('descricao', sa.Text(), nullable=True))
    op.add_column('categorias', sa.Column('ordem', sa.Integer(), nullable=False))
    op.add_column('categorias', sa.Column('ativa', sa.Boolean(), nullable=False))
    op.add_column('clientes', sa.Column('default_address_id', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('clientes', sa.Column('metadata_extra', sa.JSON(), nullable=False))
    op.add_column('itens_pedido', sa.Column('nome_snapshot', sa.String(length=255), nullable=True))
    op.add_column('itens_pedido', sa.Column('merchant_id', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('itens_pedido', sa.Column('prestador_id', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('itens_pedido', sa.Column('categoria_id_snapshot', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('itens_pedido', sa.Column('total_linha', sa.Numeric(precision=10, scale=2), nullable=False))
    op.create_foreign_key(None, 'itens_pedido', 'merchants', ['merchant_id'], ['id'], ondelete='SET NULL')
    op.create_foreign_key(None, 'itens_pedido', 'prestadores', ['prestador_id'], ['id'], ondelete='SET NULL')
    op.add_column('merchants', sa.Column('descricao', sa.Text(), nullable=True))
    op.add_column('merchants', sa.Column('logo_url', sa.String(length=500), nullable=True))
    op.add_column('merchants', sa.Column('banner_url', sa.String(length=500), nullable=True))
    op.add_column('merchants', sa.Column('telefone', sa.String(length=50), nullable=True))
    op.add_column('merchants', sa.Column('email_contacto', sa.String(length=255), nullable=True))
    op.add_column('merchants', sa.Column('endereco_rua', sa.String(length=255), nullable=True))
    op.add_column('merchants', sa.Column('endereco_cidade', sa.String(length=120), nullable=True))
    op.add_column('merchants', sa.Column('endereco_codigo_postal', sa.String(length=30), nullable=True))
    op.add_column('merchants', sa.Column('endereco_pais', sa.String(length=120), nullable=True))
    op.add_column('merchants', sa.Column('latitude', sa.Numeric(precision=10, scale=7), nullable=True))
    op.add_column('merchants', sa.Column('longitude', sa.Numeric(precision=10, scale=7), nullable=True))
    op.add_column('merchants', sa.Column('horario_funcionamento', sa.JSON(), nullable=False))
    op.add_column('merchants', sa.Column('pedido_minimo', sa.Numeric(precision=10, scale=2), nullable=False))
    op.add_column('merchants', sa.Column('tempo_medio_preparacao_min', sa.Integer(), nullable=False))
    op.add_column('merchants', sa.Column('aceita_produtos', sa.Boolean(), nullable=False))
    op.add_column('merchants', sa.Column('aceita_servicos', sa.Boolean(), nullable=False))
    op.add_column('merchants', sa.Column('ativo', sa.Boolean(), nullable=False))
    op.add_column('pedidos', sa.Column('codigo_externo', sa.String(length=120), nullable=True))
    op.add_column('pedidos', sa.Column('origem', sa.Enum('WEB', 'MOBILE', 'BACKOFFICE', name='pedidoorigem'), nullable=False))
    op.add_column('pedidos', sa.Column('metodo_pagamento', sa.String(length=50), nullable=True))
    op.add_column('pedidos', sa.Column('estado_pagamento', sa.String(length=50), nullable=True))
    op.add_column('pedidos', sa.Column('endereco_entrega_snapshot', sa.JSON(), nullable=False))
    op.add_column('pedidos', sa.Column('cliente_nome_snapshot', sa.String(length=150), nullable=True))
    op.add_column('pedidos', sa.Column('cliente_email_snapshot', sa.String(length=255), nullable=True))
    op.add_column('pedidos', sa.Column('cliente_telefone_snapshot', sa.String(length=50), nullable=True))
    op.add_column('pedidos', sa.Column('data_confirmacao', sa.DateTime(timezone=True), nullable=True))
    op.add_column('pedidos', sa.Column('data_envio', sa.DateTime(timezone=True), nullable=True))
    op.add_column('pedidos', sa.Column('data_conclusao', sa.DateTime(timezone=True), nullable=True))
    op.add_column('prestadores', sa.Column('bio', sa.Text(), nullable=True))
    op.add_column('prestadores', sa.Column('foto_url', sa.String(length=500), nullable=True))
    op.add_column('prestadores', sa.Column('avaliacao_media', sa.Numeric(precision=3, scale=2), nullable=False))
    op.add_column('prestadores', sa.Column('total_avaliacoes', sa.Integer(), nullable=False))
    op.add_column('prestadores', sa.Column('zona_atendimento', sa.JSON(), nullable=False))
    op.add_column('prestadores', sa.Column('atende_ao_domicilio', sa.Boolean(), nullable=False))
    op.add_column('prestadores', sa.Column('atende_online', sa.Boolean(), nullable=False))
    op.add_column('prestadores', sa.Column('linguas', sa.JSON(), nullable=False))
    op.add_column('prestadores', sa.Column('ativo', sa.Boolean(), nullable=False))
    op.add_column('produtos', sa.Column('descricao_curta', sa.String(length=255), nullable=True))
    op.add_column('produtos', sa.Column('descricao_detalhada', sa.Text(), nullable=True))
    op.add_column('produtos', sa.Column('sku', sa.String(length=100), nullable=True))
    op.add_column('produtos', sa.Column('stock_atual', sa.Integer(), nullable=False))
    op.add_column('produtos', sa.Column('stock_minimo', sa.Integer(), nullable=False))
    op.add_column('produtos', sa.Column('categoria_id', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('produtos', sa.Column('imagens', sa.JSON(), nullable=False))
    op.add_column('produtos', sa.Column('atributos_extras', sa.JSON(), nullable=False))
    op.add_column('produtos', sa.Column('permitir_backorder', sa.Boolean(), nullable=False))
    op.add_column('produtos', sa.Column('max_por_pedido', sa.Integer(), nullable=True))
    op.add_column('produtos', sa.Column('ativo', sa.Boolean(), nullable=False))
    op.create_foreign_key(None, 'produtos', 'categorias', ['categoria_id'], ['id'], ondelete='SET NULL')
    op.add_column('servicos', sa.Column('descricao_curta', sa.String(length=255), nullable=True))
    op.add_column('servicos', sa.Column('descricao_detalhada', sa.Text(), nullable=True))
    op.add_column('servicos', sa.Column('duracao_minutos', sa.Integer(), nullable=True))
    op.add_column('servicos', sa.Column('categoria_id', app.infrastructure.db.types.GUID(), nullable=True))
    op.add_column('servicos', sa.Column('imagens', sa.JSON(), nullable=False))
    op.add_column('servicos', sa.Column('tags', sa.JSON(), nullable=False))
    op.add_column('servicos', sa.Column('politica_cancelamento', sa.Text(), nullable=True))
    op.add_column('servicos', sa.Column('tipo_atendimento', sa.Enum('PRESENCIAL', 'ONLINE', 'DOMICILIO', 'MISTO', name='servicotipoatendimento'), nullable=False))
    op.add_column('servicos', sa.Column('ativo', sa.Boolean(), nullable=False))
    op.create_foreign_key(None, 'servicos', 'categorias', ['categoria_id'], ['id'], ondelete='SET NULL')
    op.add_column('tenants', sa.Column('timezone', sa.String(length=64), nullable=False))
    op.add_column('tenants', sa.Column('moeda_padrao', sa.String(length=10), nullable=False))
    op.add_column('tenants', sa.Column('config_checkout', sa.JSON(), nullable=False))
    op.add_column('tenants', sa.Column('branding', sa.JSON(), nullable=False))
    # ### end Alembic commands ###


def downgrade() -> None:
    """Revert upgrade migrations."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('tenants', 'branding')
    op.drop_column('tenants', 'config_checkout')
    op.drop_column('tenants', 'moeda_padrao')
    op.drop_column('tenants', 'timezone')
    op.drop_constraint(None, 'servicos', type_='foreignkey')
    op.drop_column('servicos', 'ativo')
    op.drop_column('servicos', 'tipo_atendimento')
    op.drop_column('servicos', 'politica_cancelamento')
    op.drop_column('servicos', 'tags')
    op.drop_column('servicos', 'imagens')
    op.drop_column('servicos', 'categoria_id')
    op.drop_column('servicos', 'duracao_minutos')
    op.drop_column('servicos', 'descricao_detalhada')
    op.drop_column('servicos', 'descricao_curta')
    op.drop_constraint(None, 'produtos', type_='foreignkey')
    op.drop_column('produtos', 'ativo')
    op.drop_column('produtos', 'max_por_pedido')
    op.drop_column('produtos', 'permitir_backorder')
    op.drop_column('produtos', 'atributos_extras')
    op.drop_column('produtos', 'imagens')
    op.drop_column('produtos', 'categoria_id')
    op.drop_column('produtos', 'stock_minimo')
    op.drop_column('produtos', 'stock_atual')
    op.drop_column('produtos', 'sku')
    op.drop_column('produtos', 'descricao_detalhada')
    op.drop_column('produtos', 'descricao_curta')
    op.drop_column('prestadores', 'ativo')
    op.drop_column('prestadores', 'linguas')
    op.drop_column('prestadores', 'atende_online')
    op.drop_column('prestadores', 'atende_ao_domicilio')
    op.drop_column('prestadores', 'zona_atendimento')
    op.drop_column('prestadores', 'total_avaliacoes')
    op.drop_column('prestadores', 'avaliacao_media')
    op.drop_column('prestadores', 'foto_url')
    op.drop_column('prestadores', 'bio')
    op.drop_column('pedidos', 'data_conclusao')
    op.drop_column('pedidos', 'data_envio')
    op.drop_column('pedidos', 'data_confirmacao')
    op.drop_column('pedidos', 'cliente_telefone_snapshot')
    op.drop_column('pedidos', 'cliente_email_snapshot')
    op.drop_column('pedidos', 'cliente_nome_snapshot')
    op.drop_column('pedidos', 'endereco_entrega_snapshot')
    op.drop_column('pedidos', 'estado_pagamento')
    op.drop_column('pedidos', 'metodo_pagamento')
    op.drop_column('pedidos', 'origem')
    op.drop_column('pedidos', 'codigo_externo')
    op.drop_column('merchants', 'ativo')
    op.drop_column('merchants', 'aceita_servicos')
    op.drop_column('merchants', 'aceita_produtos')
    op.drop_column('merchants', 'tempo_medio_preparacao_min')
    op.drop_column('merchants', 'pedido_minimo')
    op.drop_column('merchants', 'horario_funcionamento')
    op.drop_column('merchants', 'longitude')
    op.drop_column('merchants', 'latitude')
    op.drop_column('merchants', 'endereco_pais')
    op.drop_column('merchants', 'endereco_codigo_postal')
    op.drop_column('merchants', 'endereco_cidade')
    op.drop_column('merchants', 'endereco_rua')
    op.drop_column('merchants', 'email_contacto')
    op.drop_column('merchants', 'telefone')
    op.drop_column('merchants', 'banner_url')
    op.drop_column('merchants', 'logo_url')
    op.drop_column('merchants', 'descricao')
    op.drop_constraint(None, 'itens_pedido', type_='foreignkey')
    op.drop_constraint(None, 'itens_pedido', type_='foreignkey')
    op.drop_column('itens_pedido', 'total_linha')
    op.drop_column('itens_pedido', 'categoria_id_snapshot')
    op.drop_column('itens_pedido', 'prestador_id')
    op.drop_column('itens_pedido', 'merchant_id')
    op.drop_column('itens_pedido', 'nome_snapshot')
    op.drop_column('clientes', 'metadata_extra')
    op.drop_column('clientes', 'default_address_id')
    op.drop_column('categorias', 'ativa')
    op.drop_column('categorias', 'ordem')
    op.drop_column('categorias', 'descricao')
    op.drop_column('categorias', 'slug')
    op.drop_column('agendamentos', 'motivo_cancelamento')
    op.drop_column('agendamentos', 'data_cancelamento')
    op.drop_column('agendamentos', 'data_confirmacao')
    op.drop_column('agendamentos', 'notas_internas')
    op.drop_column('agendamentos', 'canal')
    op.drop_column('agendamentos', 'endereco_atendimento')
    op.drop_column('agendamentos', 'preco_confirmado')
    # ### end Alembic commands ###
